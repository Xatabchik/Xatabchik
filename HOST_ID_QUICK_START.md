# üÜî Host ID - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

- ‚ú® –ö–∞–∂–¥—ã–π —Ö–æ—Å—Ç —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π **—á–∏—Å–ª–æ–≤–æ–π ID** (`host_id`)
- üìä ID –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—ã: `xui_hosts`, `vpn_keys`, `plans`
- üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- üîó –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å `host_name`

---

## üìö –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ ID

```python
from src.shop_bot.data_manager.database import (
    get_host_by_id,
    get_host_id,
    get_host_name_by_id
)

# –ü–æ–ª—É—á–∏—Ç—å ID —Ö–æ—Å—Ç–∞ –ø–æ –∏–º–µ–Ω–∏
host_id = get_host_id("my-server")

# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ ID
host = get_host_by_id(host_id)

# –ü–æ–ª—É—á–∏—Ç—å –∏–º—è –ø–æ ID
name = get_host_name_by_id(123)
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤ –∏ –∫–ª—é—á–µ–π –ø–æ ID

```python
from src.shop_bot.data_manager.database import (
    get_plans_by_host_id,
    get_keys_by_host_id
)

# –¢–∞—Ä–∏—Ñ—ã
plans = get_plans_by_host_id(123)

# –ö–ª—é—á–∏
keys = get_keys_by_host_id(123)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π

```python
from src.shop_bot.data_manager.database import (
    update_key_host_id
)

# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∫–ª—é—á –Ω–∞ –¥—Ä—É–≥–æ–π —Ö–æ—Å—Ç –ø–æ ID
update_key_host_id(key_id=456, new_host_id=789)
```

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
```bash
python -m src.shop_bot
```

–õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç:
```
üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è host_id –¥–ª—è X —Ö–æ—Å—Ç–æ–≤...
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ X –∫–ª—é—á–µ–π —Å host_id
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ X –ø–ª–∞–Ω–æ–≤ —Å host_id
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ö–æ—Å—Ç–∞
```python
host = get_host_by_id(123)
print(f"–•–æ—Å—Ç: {host['host_name']}")
print(f"URL: {host['host_url']}")
```

### –ü—Ä–∏–º–µ—Ä 2: –°–æ–∑–¥–∞—Ç—å —Ö–æ—Å—Ç (–ø–æ–ª—É—á–∏—Ç—å ID)
```python
host_id = create_host(
    name="new-host",
    url="https://example.com",
    user="",
    passwd="",
    inbound=0
)
print(f"–°–æ–∑–¥–∞–Ω —Ö–æ—Å—Ç —Å ID: {host_id}")
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö–æ—Å—Ç–∞
```python
host_id = get_host_id("my-server")
if host_id:
    host = get_host_by_id(host_id)
    plans = get_plans_by_host_id(host_id)
    keys = get_keys_by_host_id(host_id)
    print(f"üìã –¢–∞—Ä–∏—Ñ–æ–≤: {len(plans)}")
    print(f"üîë –ö–ª—é—á–µ–π: {len(keys)}")
```

---

## üîÄ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–°—Ç–∞—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ:
- `get_host(host_name)` ‚úÖ
- `get_plans_for_host(host_name)` ‚úÖ
- `update_key_host(key_id, host_name)` ‚úÖ

–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å ID:
- `get_host_by_id(host_id)` ‚ú®
- `get_plans_by_host_id(host_id)` ‚ú®
- `update_key_host_id(key_id, host_id)` ‚ú®

---

## üìù –ß—Ç–æ –≤ –ë–î

### –¢–∞–±–ª–∏—Ü–∞ xui_hosts
- ‚úÖ `host_id INTEGER UNIQUE` - –Ω–æ–≤–æ–µ –ø–æ–ª–µ
- ‚úÖ `created_at TIMESTAMP` - –Ω–æ–≤–æ–µ –ø–æ–ª–µ
- ‚úÖ `updated_at TIMESTAMP` - –Ω–æ–≤–æ–µ –ø–æ–ª–µ
- ‚úÖ `host_name TEXT` - –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É PRIMARY KEY

### –¢–∞–±–ª–∏—Ü–∞ vpn_keys
- ‚úÖ `host_id INTEGER` - –Ω–æ–≤–æ–µ –ø–æ–ª–µ (—Å–≤—è–∑—å —Å —Ö–æ—Å—Ç–æ–º)

### –¢–∞–±–ª–∏—Ü–∞ plans
- ‚úÖ `host_id INTEGER` - –Ω–æ–≤–æ–µ –ø–æ–ª–µ (—Å–≤—è–∑—å —Å —Ö–æ—Å—Ç–æ–º)

### –ò–Ω–¥–µ–∫—Å—ã
AUTO-Created –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:
- `idx_xui_hosts_host_id` - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ ID
- `idx_vpn_keys_host_id` - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –∫–ª—é—á–µ–π
- `idx_plans_host_id` - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —Ç–∞—Ä–∏—Ñ–æ–≤

---

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ host_name –∫–æ–≥–¥–∞:
- –†–∞–±–æ—Ç–∞–µ—Ç–µ —Å –∏–º–µ–Ω–µ–º —Ö–æ—Å—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é
- –ù—É–∂–Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ host_id –∫–æ–≥–¥–∞:
- –ù—É–∂–Ω–∞ –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –†–∞–±–æ—Ç–∞–µ—Ç–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏/API
- –û–±–Ω–æ–≤–ª—è–µ—Ç–µ –∏–ª–∏ –∏—â–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ
- –ù—É–∂–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

---

## üìñ –ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [HOST_ID_IMPLEMENTATION.md](HOST_ID_IMPLEMENTATION.md)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**–î–∞—Ç–∞:** 14 —Ñ–µ–≤—Ä–∞–ª—è 2026
